#and remove two otus fromcoamplified sponges for 18s
#Take out OTU 1 for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa[-c(47)]
countSum<-apply(otu_and_taxa[3:46],1,sum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4206
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4206"),]
#filtering: should be done seperate for both 16 and 18s data set
#Keep rows that have more than 50 counds and are from 16s data set OR have more than 5 counts and belong to 18s ddataset
otus_and_taxab<-otus_and_taxa[otus_and_taxa$countSum > 50 & otus_and_taxa$dataset=="16s"|otus_and_taxa$countSum > 5 & otus_and_taxa$dataset=="18s",]
View(otus_and_taxab)
head(otus_and_taxab)
data_all<-otus_and_taxab
#just 16s
data_16<-data_all[data_all$dataset=="16s"]
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
head(data_16)
dim(data_16)
dim(data_all)
#just 18s
data_18<-data_all[data_all$dataset=="18s",]
dim(data_18)
library(vegan)
library(matrixStats)
library(dplyr)
matrix_file<-"./Data/16and18s_otu.csv"
tus<-arrange(otus, X.OTU.ID)
taotus<-read.csv("./Data/16and18s_otu.csv", sep=";")
#BInd taxonomy to remove bacterial OTUs from 18s dataset
taxa<-read.csv("./Data/16ans18s_taxa.csv",sep=";")
head(otus)
taxa<-arrange(taxa,sequence_identifier)
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU 1 for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa[-c(47)]
countSum<-apply(otu_and_taxa[3:46],1,sum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4206
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4206"),]
#fILTER TO KEEP TOP 95%
pct<-otus_and_taxa$countSum/sum(otus_and_taxa$countSum)
otus_and_taxab<-cbind(otus_and_taxa, pct)
otus_and_taxac<-otus_and_taxab%>%
arrange(desc(pct))
otus_and_taxac<-otus_and_taxac%>%
mutate(cumpct=cumsum(pct))
#filtering: should be done seperate for both 16 and 18s data set
#Keep rows that have more than 50 counds and are from 16s data set OR have more than 5 counts and belong to 18s ddataset
otus_and_taxad<-otus_and_taxac[otus_and_taxac$countSum > 50 & otus_and_taxac$dataset=="16s"|otus_and_taxac$countSum > 5 & otus_and_taxac$dataset=="18s",]
View(otus_and_taxac)
#otus_and_taxac<-otus_and_taxac[otus_and_taxac$cumpct < 0.95,]
oat<-otus_and_taxad[,-c(1,47:57)]
#rEMOVE SEQUENCE id AS A COLUMN AND MAKE THEM THE ROW NAMES
row.names(oat)<-oat$X.OTU.ID
#remove column with id names and taxa columns again
oat<-oat[,-1]
#groups
#T aurantium: GW1941 till GW1951 inclusive
#T meloni: GW1952 till GW1962
# T citroni: GW1963 till GW1984 inclusive
#group vectors for non bactloadCorrected datasets
num_groups<-c(1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3)
label_groups<-c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci")
head(oat)
dim(oat)
nmds<-metaMDS(t(oat), try=50)
tiff("./Figures/16and18splots/ordination_nmds_plot.tiff",height=20,width=20,units="cm",res=300)
plot(nmds, type = "t", display="sites")
points(nmds, col=num_groups, cex=1.5, pch=16)
ordispider(nmds, label_groups, label=T)
dev.off()
x<-anosim(t(oat), num_groups)
summary(x)
x$statistic
hist(x$perm)
#vector
species_vector<-data.frame(Species=c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci"))
#wFreqs_more50Counts % more1PctCounts
#temp_treatments<-data.frame(Condition=c("C","C","C","T","T","C","C","C","T","C","C","T","C","C","C","T")
#                           , Sponge_type=c("G","G","G","G","G","G","G","G","G","P","P","P","P","P","P","P"))
#adonis(t(bact_matrix)~Condition, data=temp_treatments, strata=temp_treatments$Sponge_type)
meta_cca<-cca(t(oat)~Species, data=species_vector)
#bact_cca<-cca(t(bact_matrix[-c(17,18)])~Condition+Sponge_type+Condition:Sponge_type, data=temp_treatments)
tiff("./Figures/16and18splots/ordination_cca_plot.tiff",height=20,width=20,units="cm",res=300)
plot(meta_cca, type="t", display="sites")
points(meta_cca, col=num_groups, cex=1.5, pch=16)
ordispider(meta_cca, label_groups, label=T)
dev.off()
anova(meta_cca)
anova(meta_cca, by="term")
anova(meta_cca, by="margin")
#highly variable otus
is.matrix(oat)
matrixoat<-as.matrix(oat)
matrix_rMeans<-rowMeans(matrixoat)
matrix_rSds<-rowSds(matrixoat)
matrix_zscores<-((matrixoat-matrix_rMeans)/matrix_rSds)
variability<-rowVars(matrixoat)
OTUVars<-cbind(oat,variability)
OTUVars<-arrange(OTUVars,by="variability")
variableOTUs<-rownames(head(OTUVars, n=25L))
tiff("./Figures/16and18splots/heatmap16and18.tiff",height=30,width=30,units="cm",res=300)
heatmap(as.matrix(matrix_zscores))
dev.off()
#ColSideColors = c("blue","red","red","blue","blue","blue","blue","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","red","blue","red","red","blue","blue","blue","blue","blue","blue","green","green","red","green","green","red","red","red","blue","blue","green","green","green","green","green","green","green"))
#here
tiff("./Figures/16and18splots/heatmap16and18.tiff",height=30,width=30,units="cm",res=300)
heatmap(matrix_zscores[rownames(matrix_zscores) %in% variableOTUs,])
dev.off()
####
####Vegemite
data(dune)
sponges<-d18s_matrix[,-c(45,46,47)]
dis<-vegdist(t(sponges))
clus<-hclust(dis,"ward.D2")
plot(clus)
#single sites to be joined into large clusters
#or use complete for compact clusters or average -neutral grouping
den<-as.dendrogram(clus)
#ord<-cca(sponges)
wa<-scores(nmds,display="sites",choices=1)
oden<-reorder(den,wa,mean)
vegemite(t(sponges),use=oden,zero="-",scale="log")
tabasco(t(sponges),use=oden,zero="-",scale="Hill") #HIll is the scale publication standard
tabasco(t(sponges),use=oden, zero="-",col = heat.colors(5), scale="Hill")
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
head(data_16)
dim(data_16)
#just 18s
data_18<-data_all[data_all$dataset=="18s",]
dim(data_18)
#Alpha, beta and gamma
library(matrixStats)
library(dplyr)
taotus<-read.csv("./Data/16and18s_otu.csv", sep=";")
otus<-arrange(taotus, X.OTU.ID)
#BInd taxonomy to remove bacterial OTUs from 18s dataset
taxa<-read.csv("./Data/16ans18s_taxa.csv",sep=";")
head(otus)
taxa<-arrange(taxa,sequence_identifier)
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU 1 for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa[-c(47)]
countSum<-apply(otu_and_taxa[3:46],1,sum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4206
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4206"),]
#filtering: should be done seperate for both 16 and 18s data set
#Keep rows that have more than 50 counds and are from 16s data set OR have more than 5 counts and belong to 18s ddataset
otus_and_taxab<-otus_and_taxa[otus_and_taxa$countSum > 50 & otus_and_taxa$dataset=="16s"|otus_and_taxa$countSum > 5 & otus_and_taxa$dataset=="18s",]
head(otus_and_taxab)
data_all<-otus_and_taxab
dim(data_all)
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
head(data_16)
dim(data_16)
#just 18s
data_18<-data_all[data_all$dataset=="18s",]
dim(data_18)
view(data_18)
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
head(data_all)
view(data_all)
View(data_all)
##
OTUpresence<-as.data.frame(data_all[,c(-1:2,-47:55]>0)#turns into logical value, true or false if present or not
##
OTUpresence<-as.data.frame(data_all[,c(-1:2,-47:55)]>0)#turns into logical value, true or false if present or not
##
OTUpresence<-as.data.frame(data_all[,-c(1:2,47:55)]>0)#turns into logical value, true or false if present or not
head(OTUpresence)
#For absence or presence data
data_all<-as.data.frame(data_all[,-c(1:2,47:55)]>0)
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
head(data_16)
data<-cbind(data_all,otus_and_taxab[1])
head(data)
data_all<-cbind(data_all,otus_and_taxab[1])
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
head(data_16)
dim(data_16)
#just 18s
data_18<-data_all[data_all$dataset=="18s",]
view(data_18)
head(data_16)
dim(data_16)
data_16<-data_16[,-45]
dim(data_16)
dim(data_18)
data_18<-data_18[,-45]
nrows(data_16)
??nrow
nrow(data_16)
View(data_16)
??sapply
#404 is gamma diversity = in all sponge samples
apply(data_16,sum,2)
#404 is gamma diversity = in all sponge samples
apply(data_16,2,sum)
#404 is gamma diversity = in all sponge samples
g_persample<-apply(data_16,2,sum)
apply(g_persample,mean)
apply(g_persample,1,mean)
as.matrix(g_persample)
apply(g_persample,2,mean)
g_persample<-as.matrix(g_persample)
apply(g_persample,2,mean)
meang_persample<-apply(g_persample,2,mean)
beta<-nrow(data_16)/meang_persample
beta
#404 is gamma diversity = in all sponge samples
g_persample18<-apply(data_18,2,sum)
g_persample18<-as.matrix(g_persample18)
meang_persample18<-apply(g_persample18,2,mean)
beta18<-nrow(data_18)/meang_persample18
beta18
###
H<-diversity(data_16)
head(data_16)
??diversity
library(vegan)
###
H<-diversity(data_16)
library(vegan)
data(BCI)
View(BCI)
###Make graphs for Alpha diversity
data_all<-otus_and_taxab
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
head(data_16s)
head(data_16)
data_16<-data_16[,-45]
#just 18s
data_18<-data_all[data_all$dataset=="18s",]
data_18<-data_18[,-45]
H<-diversity(data_16)
head(data_16)
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
View(data_16)
data_16<-data_16[,-c(1,2,47:55)]
#just 18s
data_18<-data_all[data_all$dataset=="18s",]
data_18<-data_18[,-c(1,2,47:55)]
H<-diversity(data_16)
data_16<-t(data_16)
H<-diversity(data_16)
data_16<-as.matrix(t(data_16))
#just 16s
data_16<-data_all[data_all$dataset=="16s",]
data_16<-data_16[,-c(1,2,47:55)]
data_16<-as.matrix(t(data_16))
H<-diversity(data_16)
richness<-specnumber(data_16)
species<-c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci")
max(richness)
min(richness)
evenness<-H/log(richness)#Peilous richness
alpha<-cbind(sahnnon=H, richness=richness, pielou=evenness,species)
head(alpha)
str(alpha)
is.numeric(alpha$shannon)
is.numeric(alpha$H)
is.numeric(H)
as.numeric(alpha$H)
alpha<-cbind(shannon=H, richness=richness, pielou=evenness,species)
as.numeric(alpha$shannon)
str(alpha)
as.data.frame(alpha)
alpha<-as.data.frame(alpha)
View(alpha)
str(alpha)
is.numeric(alpha$shannon)
as.numeric(alpha$shannon)
as.numeric(alpha$richness)
as.numeric(alpha$pielou)
str(alpha)
alpha$shannon<-as.numeric(alpha$shannon)
alpha$richness<-as.numeric(alpha$richness)
alpha$pielou<-as.numeric(alpha$pielou)
str(alpha)
library(ggplot2)
shanplot16<-
ggplot(alpha,aes(species,shannon,colour=species))
ggplot(alpha,aes(species,shannon,colour=species))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.4))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(paste(c(t,a,s))))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(paste(c("t","tci","s"))))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("") +
theme_bw() +
theme(axis.text.x = element_text(paste(("t","tci","s"))))
xlab(c("a","b","c") +
xlab(c("a","b","c")
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab(c("a","b","c") )
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
theme(axis.text.x = element_text(c("t","tci","s")))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
theme(axis.text.x = element_text(labels=c("t","tci","s")))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
scale_x_discrete(labels=c("t","tci","s")))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw()
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni")))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")
ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
ggplot(alpha,aes(species,richness,colour=species))+
geom_point()+
ylab("Species richness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
ggplot(alpha,aes(species,pielou,colour=species))+
geom_point()+
ylab("Pielou's evenness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
shanplot16<-ggplot(alpha,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
richplot16<-ggplot(alpha,aes(species,richness,colour=species))+
geom_point()+
ylab("Species richness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
pielouplot16<-ggplot(alpha,aes(species,pielou,colour=species))+
geom_point()+
ylab("Pielou's evenness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
plot_grid(shanplot16,richplot16,pielouplot16)
library(cowplot)
plot_grid(shanplot16,richplot16,pielouplot16)
plot_grid(shanplot16,richplot16,pielouplot16,ncol=3)
#For 18s data
H18<-diversity(data_18)
richness18<-specnumber(data_18)
species<-c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci")
evenness18<-H18/log(richness18)#Peilous richness
alpha18<-cbind(shannon=H18, richness=richness18, pielou=evenness18,species)
alpha18<-as.data.frame(alpha18)
#For 18s data
H18<-diversity(data_18)
richness18<-specnumber(data_18)
species<-c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci")
#For 18s data
data_18<-as.matrix(t(data_18))
H18<-diversity(data_18)
richness18<-specnumber(data_18)
species<-c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci")
evenness18<-H18/log(richness18)#Peilous richness
alpha18<-cbind(shannon=H18, richness=richness18, pielou=evenness18,species)
alpha18<-as.data.frame(alpha18)
alpha18$shannon<-as.numeric(alpha18$shannon)
alpha18$richness<-as.numeric(alpha18$richness)
alpha18$pielou<-as.numeric(alpha18$pielou)
shanplot18<-ggplot(alpha18,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
shanplot18
richplot18<-ggplot(alpha18,aes(species,richness,colour=species))+
geom_point()+
ylab("Species richness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
pielouplot18<-ggplot(alpha18,aes(species,pielou,colour=species))+
geom_point()+
ylab("Pielou's evenness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
plot_grid(shanplot18,richplot18,pielouplot18,ncol=3)
####For 18 and 16 merged
data_all<-t(otus_and_taxab[,-c(1:2,47:55)])
Hb<-diversity(data_all)
richnessb<-specnumber(data_all)
species<-c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci")
evennessb<-Hb/log(richnessb)#Peilous richness
alphab<-cbind(shannon=Hb, richness=richnessb, pielou=evennessb,species)
alphab<-as.data.frame(alphab)
alphab$shannon<-as.numeric(alphab$shannon)
alphab$richness<-as.numeric(alphab$richness)
alphab$pielou<-as.numeric(alphab$pielou)
shanplotb<-ggplot(alphab,aes(species,shannon,colour=species))+
geom_point()+
ylab("Shannon's H'") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
richplotb<-ggplot(alphab,aes(species,richness,colour=species))+
geom_point()+
ylab("Species richness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
pielouplotb<-ggplot(alphab,aes(species,pielou,colour=species))+
geom_point()+
ylab("Pielou's evenness") +
xlab("" )+
theme_bw() +
theme(legend.position = "none")+
scale_x_discrete(labels=c("Tau"="T.aurantium","Tci"="T.citrina","Tme"="T.meloni"))
plot_grid(shanplotb,richplotb,pielouplotb,ncol=3)
View(otus_and_taxab)
