data_all<-data_all[,2:46]
otut<-data_all[,-1]
#OTU Id as row name
rownames(otut)<-data_all[,1]
#Samples as row
otu_table<-as.data.frame(t(otut))
#calculate the total number of reads per sample
#remove both bad samples from 16s and 18s
#GW1968 and GW1956
head(otu_table)
which(rownames(otu_table)=="GW1956")
which(rownames(otu_table)=="GW1968")
dim(otu_table)
otu_table<-otu_table[-c(16,28),]
dim(otu_table)
otu_table$total <- rowSums(otu_table)
otu_table$sponge <- c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tme","Tme","Tau")
#GET NAMES OF ALL OUTS
otu_table
otus <- names(otu_table)
head(otu_table)
#PUT SAMPLES BACK AS A ROW
otu_table<-tibble::rownames_to_column(otu_table, "Sample")
xmatrix <- otu_table[,grep('OTU', names(otu_table))]
fullmatrix<-xmatrix
#Need to filter out OTUs not part of the network
#how many samples is each otu in
xmatrix[xmatrix>=1]<-1
otu_samples <- colSums(xmatrix)
#For T aurantium
##Tethya aurantium
dim(xmatrix)
taumatrix<-xmatrix[c(1:11,42),]
taumatrix_abund<-fullmatrix[c(1:11,42),]
otu_samplestau <- colSums(taumatrix)
#present in more than 90%
active_otustau <- names(otu_samplestau[otu_samplestau > 10])
filteredmat_tau<- taumatrix_abund[ ,which((names(taumatrix) %in% active_otustau)==TRUE)]
dim(filteredmat_tau)
##
rho <- propr(filteredmat_tau, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrix<-getMatrix(rho)
library(propr)
library(dplyr)
library(tibble)
library(ggdendro)
library(corrgram)
library(ggplot2)
library(bootnet)
#16 and 18
taotus<-read.csv("./Data/16and18s_otu.csv", sep=";")
otus<-arrange(taotus, X.OTU.ID)
#BInd taxonomy to remove bacterial OTUs from 18s dataset
taxa<-read.csv("./Data/16ans18s_taxa.csv",sep=";")
head(otus)
taxa<-arrange(taxa,sequence_identifier)
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
otu_and_taxa<-otu_and_taxa%>%filter(!(Class=="Demospongiae" & dataset=="18s"))
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa[-c(47)]
countSum<-apply(otu_and_taxa[3:46],1,sum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4077
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4077"),]
#filtering: should be done seperate for both 16 and 18s data set
#Keep rows that have more than 50 counds and are from 16s data set OR have more than 5 counts and belong to 18s ddataset
otus_and_taxab<-otus_and_taxa[otus_and_taxa$countSum >= 50 & otus_and_taxa$dataset=="16s"|otus_and_taxa$countSum >= 5 & otus_and_taxa$dataset=="18s",]
head(otus_and_taxab)
data_all<-otus_and_taxab
which(colnames(data_all)=="GW1984")
data_all<-data_all[,2:46]
otut<-data_all[,-1]
#OTU Id as row name
rownames(otut)<-data_all[,1]
#Samples as row
otu_table<-as.data.frame(t(otut))
#calculate the total number of reads per sample
#remove both bad samples from 16s and 18s
#GW1968 and GW1956
head(otu_table)
which(rownames(otu_table)=="GW1956")
which(rownames(otu_table)=="GW1968")
dim(otu_table)
otu_table<-otu_table[-c(16,28),]
dim(otu_table)
otu_table$total <- rowSums(otu_table)
otu_table$sponge <- c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tme","Tme","Tau")
#GET NAMES OF ALL OUTS
otu_table
otus <- names(otu_table)
head(otu_table)
#PUT SAMPLES BACK AS A ROW
otu_table<-tibble::rownames_to_column(otu_table, "Sample")
xmatrix <- otu_table[,grep('OTU', names(otu_table))]
fullmatrix<-xmatrix
#Need to filter out OTUs not part of the network
#how many samples is each otu in
xmatrix[xmatrix>=1]<-1
otu_samples <- colSums(xmatrix)
#For T aurantium
##Tethya aurantium
dim(xmatrix)
taumatrix<-xmatrix[c(1:11,42),]
taumatrix_abund<-fullmatrix[c(1:11,42),]
otu_samplestau <- colSums(taumatrix)
#present in more than 90%
active_otustau <- names(otu_samplestau[otu_samplestau > 10])
filteredmat_tau<- taumatrix_abund[ ,which((names(taumatrix) %in% active_otustau)==TRUE)]
dim(filteredmat_tau)
##
rho <- propr(filteredmat_tau, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrix<-getMatrix(rho)
tiff("Figures/Networks/Taurantium16sand18s_rho.tiff",res=300,units="cm",width=30,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T aurantium 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
head(otu_table)
svg("Figures/Networks/Tmerantium16sand18s_rho.svg",res=300,units="cm",width=20,height=20)
library(svglite)
install.packages("svglite")
library(svglite)
svglite("Figures/Networks/Tmerantium16sand18s_rho.svg",res=300,units="cm",width=20,height=20)
svg("Figures/Networks/Taurantium16sand18s_rho.svg",width=12,height=8)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T aurantium 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
#For T meloni
dim(xmatrix)
tmematrix<-xmatrix[c(12:21,40,41),]
tmematrix_abund<-fullmatrix[c(12:21,40,41),]
otu_samplestme <- colSums(tmematrix)
#present in more than 90%
active_otustme <- names(otu_samplestme[otu_samplestme > 10])
filteredmat_tme<- tmematrix_abund[ ,which((names(tmematrix) %in% active_otustme)==TRUE)]
dim(filteredmat_tme)
##
rho <- propr(filteredmat_tme, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrix<-getMatrix(rho)
png("Figures/Networks/Tmerantium16sand18s_rho.png",res=300,units="cm",width=20,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T meloni 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
svg("Figures/Networks/Tmerantium16sand18s_rho.svg",width=8,height=8)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T meloni 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
##For T citrina
dim(xmatrix)
tcimatrix<-xmatrix[c(22:39),]
tcimatrix_abund<-fullmatrix[c(22:39),]
otu_samplestci <- colSums(tcimatrix)
#present in more than 90%
active_otustci <- names(otu_samplestci[otu_samplestci > 16])
filteredmat_tci<- tcimatrix_abund[ ,which((names(tcimatrix) %in% active_otustci)==TRUE)]
head(filteredmat_tci)
##
rhotci <- propr(filteredmat_tci, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrixtci<-getMatrix(rhotci)
tiff("Figures/Networks/Tciaurantium16sand18s_rho.tiff",res=300,units="cm",width=20,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
svg("Figures/Networks/Tciaurantium16sand18s_rho.svg",width=8,height=8)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
#Repeat
#16 and 18
taotus<-read.csv("./Data/16and18s_otu.csv", sep=";")
otus<-arrange(taotus, X.OTU.ID)
#BInd taxonomy to remove bacterial OTUs from 18s dataset
taxa<-read.csv("./Data/16ans18s_taxa.csv",sep=";")
head(otus)
taxa<-arrange(taxa,sequence_identifier)
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
otu_and_taxa<-otu_and_taxa%>%filter(!(Class=="Demospongiae" & dataset=="18s"))
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa[-c(47)]
countSum<-apply(otu_and_taxa[3:46],1,sum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4077
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4077"),]
#filtering: should be done seperate for both 16 and 18s data set
#Keep rows that have more than 50 counds and are from 16s data set OR have more than 5 counts and belong to 18s ddataset
otus_and_taxab<-otus_and_taxa[otus_and_taxa$countSum >= 50 & otus_and_taxa$dataset=="16s"|otus_and_taxa$countSum >= 5 & otus_and_taxa$dataset=="18s",]
head(otus_and_taxab)
data_all<-otus_and_taxab
which(colnames(data_all)=="GW1984")
data_all<-data_all[,2:46]
otut<-data_all[,-1]
#OTU Id as row name
rownames(otut)<-data_all[,1]
#Samples as row
otu_table<-as.data.frame(t(otut))
head(otu_table)
#calculate the total number of reads per sample
#remove both bad samples from 16s and 18s
#GW1968 and GW1956
head(otu_table)
which(rownames(otu_table)=="GW1956")
which(rownames(otu_table)=="GW1968")
dim(otu_table)
otu_table<-otu_table[-c(16,28),]
dim(otu_table)
otu_table$total <- rowSums(otu_table)
otu_table$sponge <- c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tme","Tme","Tau")
#GET NAMES OF ALL OUTS
otu_table
otus <- names(otu_table)
head(otu_table)
#PUT SAMPLES BACK AS A ROW
otu_table<-tibble::rownames_to_column(otu_table, "Sample")
xmatrix <- otu_table[,grep('OTU', names(otu_table))]
fullmatrix<-xmatrix
#Need to filter out OTUs not part of the network
#how many samples is each otu in
xmatrix[xmatrix>=1]<-1
otu_samples <- colSums(xmatrix)
#For T aurantium
##Tethya aurantium
dim(xmatrix)
taumatrix<-xmatrix[c(1:11,42),]
taumatrix_abund<-fullmatrix[c(1:11,42),]
otu_samplestau <- colSums(taumatrix)
#present in more than 90%
active_otustau <- names(otu_samplestau[otu_samplestau > 10])
filteredmat_tau<- taumatrix_abund[ ,which((names(taumatrix) %in% active_otustau)==TRUE)]
dim(filteredmat_tau)
##
rho <- propr(filteredmat_tau, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrix<-getMatrix(rho)
png("Figures/Networks/Taurantium16sand18s_rho.png",res=300,units="cm",width=30,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T aurantium 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
tiff("Figures/Networks/Taurantium16sand18s_rho.tiff",res=300,units="cm",width=30,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T aurantium 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
#####
#For T meloni
dim(xmatrix)
tmematrix<-xmatrix[c(12:21,40,41),]
tmematrix_abund<-fullmatrix[c(12:21,40,41),]
otu_samplestme <- colSums(tmematrix)
#present in more than 90%
active_otustme <- names(otu_samplestme[otu_samplestme > 10])
filteredmat_tme<- tmematrix_abund[ ,which((names(tmematrix) %in% active_otustme)==TRUE)]
dim(filteredmat_tme)
##
rho <- propr(filteredmat_tme, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrix<-getMatrix(rho)
png("Figures/Networks/Tme16sand18s_rho.png",res=300,units="cm",width=20,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T meloni 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
tiff("Figures/Networks/Tme16sand18s_rho.svg",res=300,units="cm",width=20,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T meloni 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
##For T citrina
dim(xmatrix)
tcimatrix<-xmatrix[c(22:39),]
tcimatrix_abund<-fullmatrix[c(22:39),]
otu_samplestci <- colSums(tcimatrix)
#present in more than 90%
active_otustci <- names(otu_samplestci[otu_samplestci > 16])
filteredmat_tci<- tcimatrix_abund[ ,which((names(tcimatrix) %in% active_otustci)==TRUE)]
head(filteredmat_tci)
##
rhotci <- propr(filteredmat_tci, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrixtci<-getMatrix(rhotci)
tiff("Figures/Networks/Tci16sand18s_rho.tiff",res=300,units="cm",width=20,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
png("Figures/Networks/Tci16sand18s_rho.png",res=300,units="cm",width=20,height=20)
corrgram(rhomatrix,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
## Visual Network
library(igraph)
library(tidygraph)
links_tci<-as_data_frame(graph_from_adjacency_matrix(rhomatrixtci,weighted=TRUE))
otus_tci<-names(filteredmat_tci)
dataset_tci<-rep("dataset16s",49)
nodes_tci<-cbind(otus_tci,dataset_tci)
head(links_tci)
net<-graph.data.frame(links_tci,nodes_tci,directed=F)
plot(net)
net <-simplify(net, remove.multiple = F, remove.loops = T)
head(links_tci)
links_tci_filter1<-links_tci[links_tci$weight>0.5,]
links_tci_filter2<-links_tci[links_tci$weight<(-0.5),]
links_tcix<-rbind(links_tci_filter1,links_tci_filter2)
net<-graph.data.frame(links_tcix,nodes_tci,directed=F)
deg <-degree(net, mode="all")
head(nodes_tci)
colrs <-c("green", "yellow")
V(net)$color <-colrs[V(net)$dataset_tci]
E(net)$width <-E(net)$weight
plot(net,vertex.size=20,vertex.label.colour="black",pt.bg=colrs)
links_tci_filter1<-links_tci[links_tci$weight>0.7,]
links_tci_filter2<-links_tci[links_tci$weight<(-0.7),]
links_tcix<-rbind(links_tci_filter1,links_tci_filter2)
net<-graph.data.frame(links_tcix,nodes_tci,directed=F)
deg <-degree(net, mode="all")
head(nodes_tci)
colrs <-c("green", "yellow")
V(net)$color <-colrs[V(net)$dataset_tci]
E(net)$width <-E(net)$weight
plot(net,vertex.size=20,vertex.label.colour="black",pt.bg=colrs)
png("./Figures/Networks/networkdiagramtci.png",units="in",width=8,height=8,res=300)
plot(net,vertex.size=20,vertex.label.colour="black",pt.bg=colrs)
dev.off()
#Repeat
#16 and 18
taotus<-read.csv("./Data/16and18s_otu.csv", sep=";")
otus<-arrange(taotus, X.OTU.ID)
#BInd taxonomy to remove bacterial OTUs from 18s dataset
taxa<-read.csv("./Data/16ans18s_taxa.csv",sep=";")
head(otus)
taxa<-arrange(taxa,sequence_identifier)
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
otu_and_taxa<-otu_and_taxa%>%filter(!(Class=="Demospongiae" & dataset=="18s"))
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa[-c(47)]
countSum<-apply(otu_and_taxa[3:46],1,sum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4077
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4077"),]
#filtering: should be done seperate for both 16 and 18s data set
#Keep rows that have more than 50 counds and are from 16s data set OR have more than 5 counts and belong to 18s ddataset
otus_and_taxab<-otus_and_taxa[otus_and_taxa$countSum >= 50 & otus_and_taxa$dataset=="16s"|otus_and_taxa$countSum >= 5 & otus_and_taxa$dataset=="18s",]
head(otus_and_taxab)
data_all<-otus_and_taxab
which(colnames(data_all)=="GW1984")
data_all<-data_all[,2:46]
otut<-data_all[,-1]
#OTU Id as row name
rownames(otut)<-data_all[,1]
#Samples as row
otu_table<-as.data.frame(t(otut))
head(otu_table)
#calculate the total number of reads per sample
#remove both bad samples from 16s and 18s
#GW1968 and GW1956
head(otu_table)
which(rownames(otu_table)=="GW1956")
which(rownames(otu_table)=="GW1968")
dim(otu_table)
otu_table<-otu_table[-c(16,28),]
dim(otu_table)
otu_table$total <- rowSums(otu_table)
otu_table$sponge <- c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tme","Tme","Tau")
#GET NAMES OF ALL OUTS
otu_table
otus <- names(otu_table)
head(otu_table)
#PUT SAMPLES BACK AS A ROW
otu_table<-tibble::rownames_to_column(otu_table, "Sample")
xmatrix <- otu_table[,grep('OTU', names(otu_table))]
fullmatrix<-xmatrix
#Need to filter out OTUs not part of the network
#how many samples is each otu in
xmatrix[xmatrix>=1]<-1
otu_samples <- colSums(xmatrix)
#For T aurantium
##Tethya aurantium
dim(xmatrix)
taumatrix<-xmatrix[c(1:11,42),]
taumatrix_abund<-fullmatrix[c(1:11,42),]
otu_samplestau <- colSums(taumatrix)
#present in more than 90%
active_otustau <- names(otu_samplestau[otu_samplestau > 10])
filteredmat_tau<- taumatrix_abund[ ,which((names(taumatrix) %in% active_otustau)==TRUE)]
dim(filteredmat_tau)
##
rho <- propr(filteredmat_tau, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrixtau<-getMatrix(rho)
dim(xmatrix)
tmematrix<-xmatrix[c(12:21,40,41),]
tmematrix_abund<-fullmatrix[c(12:21,40,41),]
otu_samplestme <- colSums(tmematrix)
#present in more than 90%
active_otustme <- names(otu_samplestme[otu_samplestme > 10])
filteredmat_tme<- tmematrix_abund[ ,which((names(tmematrix) %in% active_otustme)==TRUE)]
dim(filteredmat_tme)
##
rho <- propr(filteredmat_tme, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrixtme<-getMatrix(rho)
links_tme<-as_data_frame(graph_from_adjacency_matrix(rhomatrixtme,weighted=TRUE))
otus_tme<-names(filteredmat_tmei)
otus_tme<-names(filteredmat_tme)
??rep()
rep(x, 2)
View(otus_tme)
head(otus_tme)
dataset_tme<-c("dataset16s","dataset16s","dataset16s","dataset16s","dataset18s","dataset18s")
#For T meloni
dim(xmatrix)
tmematrix<-xmatrix[c(12:21,40,41),]
tmematrix_abund<-fullmatrix[c(12:21,40,41),]
otu_samplestme <- colSums(tmematrix)
#present in more than 90%
active_otustme <- names(otu_samplestme[otu_samplestme > 10])
filteredmat_tme<- tmematrix_abund[ ,which((names(tmematrix) %in% active_otustme)==TRUE)]
dim(filteredmat_tme)
##
rho <- propr(filteredmat_tme, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrixtme<-getMatrix(rho)
png("Figures/Networks/Tme16sand18s_rho.png",res=300,units="cm",width=20,height=20)
corrgram(rhomatrixtme,order=TRUE,main="Rho proportionality between OTUs present in T meloni 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
tiff("Figures/Networks/Tme16sand18s_rho.svg",res=300,units="cm",width=20,height=20)
corrgram(rhomatrixtme,order=TRUE,main="Rho proportionality between OTUs present in T meloni 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
##For T citrina
dim(xmatrix)
tcimatrix<-xmatrix[c(22:39),]
tcimatrix_abund<-fullmatrix[c(22:39),]
otu_samplestci <- colSums(tcimatrix)
#present in more than 90%
active_otustci <- names(otu_samplestci[otu_samplestci > 16])
filteredmat_tci<- tcimatrix_abund[ ,which((names(tcimatrix) %in% active_otustci)==TRUE)]
head(filteredmat_tci)
##
rhotci <- propr(filteredmat_tci, metric = "rho","clr", alpha=NA,p=100)
best <- rho[">", .60]
plot(best)
#
rhomatrixtci<-getMatrix(rhotci)
tiff("Figures/Networks/Tci16sand18s_rho.tiff",res=300,units="cm",width=20,height=20)
corrgram(rhomatrixtci,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
png("Figures/Networks/Tci16sand18s_rho.png",res=300,units="cm",width=20,height=20)
corrgram(rhomatrixtci,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
tiff("Figures/Networks/Tci16sand18s_rho.tiff",res=300,units="cm",width=40,height=30)
corrgram(rhomatrixtci,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
png("Figures/Networks/Tci16sand18s_rho.png",res=300,units="cm",width=40,height=30)
corrgram(rhomatrixtci,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
png("Figures/Networks/Tci16sand18s_rho.png",res=300,units="cm",width=45,height=30)
corrgram(rhomatrixtci,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
png("Figures/Networks/Tci16sand18s_rho.png",res=300,units="cm",width=50,height=40)
corrgram(rhomatrixtci,order=TRUE,main="Rho proportionality between OTUs present in T citrina 16s and 18s samples ",
lower.panel=panel.shade, upper.panel=panel.cor, text.panel=panel.txt)
dev.off()
