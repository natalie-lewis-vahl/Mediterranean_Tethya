unique(otunumber$Phylum)
AcidobacteriotaCol<-"yellowgreen"
ActinobacteriotaCol<-"yellow2"
BacteroidotaCol<-"wheat3"
BdellovibrionotaCol<-"navyblue"
AcetothermiaCol<-"tomato3"
CampylobacterotaCol<-"tan1"
ChloroflexiCol<-"violetred2"
CrenarchaeotaCol<-"violetred"
CyanobacteriaCol<-"violet"
DadabacteriaCol<-"turquoise4"
AncK6Col<-"turquoise3"
DeinococcotaCol<-"turquoise"
AquificotaCol<-"tomato3"
DesulfobacterotaCol<-"tomato1"
EntotheonellaeotaCol<-"Violetred4"
FirmicutesCol<-"black"
FusobacteriotaCol<-"rosybrown3"
GemmatimonadotaCol<-"tan3"
MarinimicrobiaCol<-"steelblue4"
MyxococcotaCol<-"steelblue2"
NB1jCol<-"springgreen4"
NitrospinotaCol<-"springgreen2"
NitrospirotaCol<-"slategray2"
PAUC34fCol<-"slateblue"
PlanctomycetotaCol<-"purple4"
ProteobacteriaCol<-"salmon"
SAR324cladeCol<-"royalblue"
SpirochaetotaCol<-"tan4"
PoribacteriaCol<-"red2"
UnclassifiedCol<-"slategray"
VerrucomicrobiotaCol<-"purple"
WPS2Col<-"plum3"
SchekmanbacteriaCol<-"orange"
ThermoplasmatotaCol<-"yellow"
ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_brewer(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProtobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col)) +
ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_brewer(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProtobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_brewer(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProteobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProteobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProteobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggpie<-ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProteobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum",width=8,height=8,units="in",res=300)
ggsave("ggpiechart_NumbotusperPhylum.png",width=8,height=8,units="in",res=300)
ggsave("ggpiechart_NumbotusperPhylum.png",width=8,height=8,units="in",rep=300)
ggsave("ggpiechart_NumbotusperPhylum.png",width=8,height=8,units="in",dpi=300)
ggsave("ggpiechart_NumbotusperPhylum_withoutunclass.png",width=8,height=8,units="in",dpi=300)
ggpie<-ggplot(otunumber, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProteobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggpie
unique(otunumber$Phylum)
ggpie<-ggplot(otunumber, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggpie<-ggplot(otunumber, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum_withunclass.png",width=8,height=8,units="in",dpi=300)
ggsave("ggpiechart_NumbotusperPhylum_withunclass.png",width=8,height=8,units="in",dpi=300)
ggpie2<-ggplot(otunumber, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum_withoutunclass.png",width=8,height=8,units="in",dpi=300)
ggpie2<-ggplot(otunumber, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,Unclassified,
VerrucomicrobiotaCol,WPS2Col))
ggpie2<-ggplot(otunumber, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col))
ggpie2<-ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum_withoutunclass.png",width=8,height=8,units="in",dpi=300)
ggplot(otunumber, aes(x=as.factor(Phylum), fill=as.factor(Phylum) )) +
geom_bar( ) +
scale_fill_manual(values = c("red", "green", "blue") ) +
theme(legend.position="none")
ggplot(otunumber, aes(x=as.factor(Phylum), fill=as.factor(Phylum) )) +
geom_bar( ) +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")
ggplot(otunumber, aes(x=as.factor(n), fill=as.factor(Phylum) )) +
geom_bar( ) +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")
ggplot(otunumber, aes(x=n, fill=as.factor(Phylum) )) +
geom_bar( ) +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")
ggplot(otunumber, aes(x=as.factor(Phylum),y=n, fill=as.factor(Phylum) )) +
geom_bar( ) +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")
ggplot(otunumber, aes(y=n, fill=as.factor(Phylum) )) +
geom_bar( ) +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")
head(otunumber)
dim(otunumber)
ggplot(otunumber, aes(y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")
ggsave("ggbarchart_NumbotusperPhylum_withoutunclass.png",width=8,height=8,units="in",dpi=300)
ggsave("ggbarchart_NumbotusperPhylum_withoutunclass.png",width=8,height=4,units="in",dpi=300)
ggsave("ggbarchart_NumbotusperPhylum_withunclass.png",width=16,height=4,units="in",dpi=300)
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90),axis.title.y = "Number of OTUs")
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90),axis.title.y =element_text( "Number of OTUs"))
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))+
labs(y="Number of OTUs")
ggsave("ggbarchart_NumbotusperPhylum_withunclass.png",width=16,height=4,units="in",dpi=300)
ggsave("ggbarchart_NumbotusperPhylum_withunclass.png",width=10,height=6,units="in",dpi=300)
##For relative abundance
relativeabundancephyla<-taxa%>%
group_by(Phylum)%>%
summarise(relative_abundance=size/sum(size))
head(relativeabundancephyla)
View(relativeabundancephyla)
##For relative abundance
relativeabundancephyla<-taxa%>%
summarise(relative_abundance=size/sum(size))
View(relativeabundancephyla)
data2<-cbind(taxa,relativeabundancephyla)
ggplot(data2, aes(x="", y=relative_abundance, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,
PoribacteriaCol,ProteobacteriaCol,PlanctomycetotaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggplot(data2, aes(x="", y=relative_abundance, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggplot(data2, aes(x="", y=relative_abundance, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
unique(otunumber$Phyla)
unique(otunumber$Phylum)
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibridotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))+
labs(y="Number of OTUs")
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))+
labs(y="Number of OTUs")
ggsave("ggbarchart_NumbotusperPhylum_withunclass.png",width=10,height=6,units="in",dpi=300)
ggpie<-ggplot(otunumber, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum_withunclass.png",width=8,height=8,units="in",dpi=300)
ggpie2<-ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum_withoutunclass.png",width=8,height=8,units="in",dpi=300)
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))+
labs(y="Number of OTUs")
ggsave("ggbarchart_NumbotusperPhylum_withunclass.png",width=10,height=6,units="in",dpi=300)
ggplot(data2, aes(x="", y=relative_abundance, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,
UnclassifiedCol,VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum_withoutunclass.png",width=8,height=8,units="in",dpi=300)
ggpie2<-ggplot(otunumberx, aes(x="", y=n, fill=Phylum)) +
geom_bar(stat="identity", width=1) +
coord_polar("y", start=0)+
theme_void()+
scale_fill_manual(values=c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col))
ggsave("ggpiechart_NumbotusperPhylum_withoutunclass.png",width=8,height=8,units="in",dpi=300)
ggplot(otunumber, aes(x=Phylum,y=n, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))+
labs(y="Number of OTUs")
ggsave("ggbarchart_NumbotusperPhylum_withunclass.png",width=10,height=6,units="in",dpi=300)
ggplot(taxa, aes(x=Phylum,y=relative_abundance, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))+
labs(y="Number of OTUs")
ggplot(data2, aes(x=Phylum,y=relative_abundance, fill=as.factor(Phylum) )) +
geom_bar( stat="identity") +
scale_fill_manual(values = c(AcetothermiaCol,AcidobacteriotaCol,ActinobacteriotaCol,AncK6Col,AquificotaCol,BacteroidotaCol,
BdellovibrionotaCol,CampylobacterotaCol,ChloroflexiCol,CrenarchaeotaCol,CyanobacteriaCol,
DadabacteriaCol,DeinococcotaCol,DesulfobacterotaCol,
EntotheonellaeotaCol,FirmicutesCol,FusobacteriotaCol,GemmatimonadotaCol,
MarinimicrobiaCol,MyxococcotaCol,NB1jCol,NitrospinotaCol,NitrospirotaCol,PAUC34fCol,
PlanctomycetotaCol,PoribacteriaCol,ProteobacteriaCol,SAR324cladeCol,
SchekmanbacteriaCol,SpirochaetotaCol,ThermoplasmatotaCol,UnclassifiedCol,
VerrucomicrobiotaCol,WPS2Col) ) +
theme(legend.position="none")+  theme(axis.text.x = element_text(angle = 90))+
labs(y="Relative abundance")
ggsave("ggbarchart_relative abundance.png",width=10,height=6,units="in",dpi=300)
