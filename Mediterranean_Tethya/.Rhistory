xs12otuRAD<-rad.zipf(t(cat[c(13)]))
xs13otuRAD<-rad.zipfbrot(t(cat[c(14)]))
xs14otuRAD<-rad.zipf(t(cat[c(15)]))
xs15otuRAD<-rad.zipf(t(cat[c(16)]))
xs16otuRAD<-rad.zipf(t(cat[c(17)]))
xs17otuRAD<-rad.zipf(t(cat[c(18)]))
xs18otuRAD<-rad.zipf(t(cat[c(19)]))
xs19otuRAD<-rad.zipfbrot(t(cat[c(20)]))
xs20otuRAD<-rad.zipfbrot(t(cat[c(21)]))
xs21otuRAD<-rad.zipfbrot(t(cat[c(22)]))
xs22otuRAD<-rad.zipf(t(cat[c(23)]))
#For species T.citroni
xs23otuRAD<-rad.zipf(t(cat[c(24)]))
xs24otuRAD<-rad.zipf(t(cat[c(25)]))
xs25otuRAD<-rad.zipf(t(cat[c(26)]))
xs26otuRAD<-rad.preempt(t(cat[c(27)]))
xs27otuRAD<-rad.zipf(t(cat[c(28)]))
xs28otuRAD<-rad.preempt(t(cat[c(29)]))
xs29otuRAD<-rad.zipf(t(cat[c(30)]))
xs30otuRAD<-rad.zipf(t(cat[c(31)]))
xs31otuRAD<-rad.zipf(t(cat[c(32)]))
xs32otuRAD<-rad.preempt(t(cat[c(33)]))
xs33otuRAD<-rad.zipf(t(cat[c(34)]))
xs34otuRAD<-rad.zipf(t(cat[c(35)]))
xs35otuRAD<-rad.zipf(t(cat[c(36)]))
xs36otuRAD<-rad.zipf(t(cat[c(37)]))
xs37otuRAD<-rad.zipfbrot(t(cat[c(38)]))
xs38otuRAD<-rad.zipf(t(cat[c(39)]))
xs39otuRAD<-rad.preempt(t(cat[c(40)]))
xs40otuRAD<-rad.zipf(t(cat[c(41)]))
xs41otuRAD<-rad.zipf(t(cat[c(42)]))
xs42otuRAD<-rad.zipfbrot(t(cat[c(43)]))
xs43otuRAD<-rad.lognormal(t(cat[c(44)]))
xs44otuRAD<-rad.zipf(t(cat[c(45)]))
#Plot everything together
png("./Figures/18splots/xoturad_grouped.png")
par(mfrow=c(3,4))#13650
#For sp 1
plot(xs2otuRAD,pch=1,lty=1,col=2,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf",cex=1)
points(xs3otuRAD,col=2)
lines(xs3otuRAD,col=2)
points(xs5otuRAD,col=2)
lines(xs5otuRAD,col=2)
points(xs6otuRAD,col=2)
lines(xs6otuRAD,col=2)
points(xs7otuRAD,col=2)
lines(xs7otuRAD,col=2)
points(xs8otuRAD,col=2)
lines(xs8otuRAD,col=2)
plot(xs1otuRAD,pch=1,lty=1,col=7,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf-mandelbrot",cex=1)
points(xs4otuRAD,col=7)
lines(xs4otuRAD,col=7)
points(xs9otuRAD,col=7)
lines(xs9otuRAD,col=7)
points(xs10otuRAD,col=7)
lines(xs10otuRAD,col=7)
plot(xs11otuRAD,pch=1,lty=1,col=11,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Lognormal",cex=1)
plot.new()
#For sp 2 #phylumRADPlot
plot(xs12otuRAD,pch=1,lty=1,col=2,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf",cex=1)
points(xs14otuRAD,col=2)
lines(xs14otuRAD,col=2)
points(xs15otuRAD,col=2)
lines(xs15otuRAD,col=2)
points(xs16otuRAD,col=2)
lines(xs16otuRAD,col=2)
points(xs17otuRAD,col=2)
lines(xs17otuRAD,col=2)
points(xs18otuRAD,col=2)
lines(xs18otuRAD,col=2)
points(xs22otuRAD,col=2)
lines(xs22otuRAD,col=2)
plot(xs13otuRAD,pch=1,lty=1,col=7,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf-mandelbrot",cex=1)
points(xs19otuRAD,col=7)
lines(xs19otuRAD,col=7)
points(xs20otuRAD,col=7)
lines(xs20otuRAD,col=7)
points(xs21otuRAD,col=7)
lines(xs21otuRAD,col=7)
plot.new()
plot.new()
#########################
#For species 3
plot(xs26otuRAD,col=6,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Preemption",cex=1)
points(xs28otuRAD,col=6)
lines(xs28otuRAD,col=6)
points(xs32otuRAD,col=6)
lines(xs32otuRAD,col=6)
points(xs39otuRAD,col=6)
lines(xs39otuRAD,col=6)
plot(xs23otuRAD,pch=1,lty=1,col=2,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf",cex=1)
points(xs24otuRAD,col=2)
lines(xs24otuRAD,col=2)
points(xs25otuRAD,col=2)
lines(xs25otuRAD,col=2)
points(xs27otuRAD,col=2)
lines(xs27otuRAD,col=2)
points(xs29otuRAD,col=2)
lines(xs29otuRAD,col=2)
points(xs30otuRAD,col=2)
lines(xs30otuRAD,col=2)
points(xs31otuRAD,col=2)
lines(xs31otuRAD,col=2)
points(xs33otuRAD,col=2)
lines(xs33otuRAD,col=2)
points(xs34otuRAD,col=2)
lines(xs34otuRAD,col=2)
points(xs35otuRAD,col=2)
lines(xs35otuRAD,col=2)
points(xs36otuRAD,col=2)
lines(xs36otuRAD,col=2)
points(xs38otuRAD,col=2)
lines(xs38otuRAD,col=2)
points(xs40otuRAD,col=2)
lines(xs40otuRAD,col=2)
points(xs44otuRAD,col=2)
lines(xs44otuRAD,col=2)
plot(xs43otuRAD,col=11,ylim=c(1,6520),xlim=c(0,110))
mtext(side=3,"Lognormal",cex=1)
plot(xs37otuRAD,col=7,ylim=c(1,6520),xlim=c(0,110))
mtext(side=3,"Zipf-mandelbrot",cex=1)
points(xs42otuRAD,col=7)
lines(xs42otuRAD,col=7)
dev.off()
xotuRAD_test<-rad_test(xotuRAD, conf.level = 0.95, log = T, )
#5 11 and 22 didnt't converge
#head(cat)
xotuRAD<-radfit(t(cat[c(2:45)]))
png("./Figures/18splots/xoturad_grouped.png")
par(mfrow=c(3,4))#13650
#For sp 1
plot(xs2otuRAD,pch=1,lty=1,col=2,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf",cex=1)
points(xs3otuRAD,col=2)
lines(xs3otuRAD,col=2)
points(xs5otuRAD,col=2)
lines(xs5otuRAD,col=2)
points(xs6otuRAD,col=2)
lines(xs6otuRAD,col=2)
points(xs7otuRAD,col=2)
lines(xs7otuRAD,col=2)
points(xs8otuRAD,col=2)
lines(xs8otuRAD,col=2)
plot(xs1otuRAD,pch=1,lty=1,col=7,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf-mandelbrot",cex=1)
points(xs9otuRAD,col=7)
lines(xs9otuRAD,col=7)
plot(xs11otuRAD,pch=1,lty=1,col=11,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Lognormal",cex=1)
plot.new()
#For sp 2 #phylumRADPlot
plot(xs12otuRAD,pch=1,lty=1,col=2,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf",cex=1)
points(xs14otuRAD,col=2)
lines(xs14otuRAD,col=2)
points(xs15otuRAD,col=2)
lines(xs15otuRAD,col=2)
points(xs16otuRAD,col=2)
lines(xs16otuRAD,col=2)
points(xs17otuRAD,col=2)
lines(xs17otuRAD,col=2)
points(xs18otuRAD,col=2)
lines(xs18otuRAD,col=2)
points(xs22otuRAD,col=2)
lines(xs22otuRAD,col=2)
plot(xs13otuRAD,pch=1,lty=1,col=7,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf-mandelbrot",cex=1)
points(xs19otuRAD,col=7)
lines(xs19otuRAD,col=7)
points(xs20otuRAD,col=7)
lines(xs20otuRAD,col=7)
plot.new()
plot.new()
#########################
#For species 3
plot(xs26otuRAD,col=6,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Preemption",cex=1)
points(xs28otuRAD,col=6)
lines(xs28otuRAD,col=6)
points(xs32otuRAD,col=6)
lines(xs32otuRAD,col=6)
points(xs39otuRAD,col=6)
lines(xs39otuRAD,col=6)
plot(xs23otuRAD,pch=1,lty=1,col=2,ylim=c(1,13650),xlim=c(0,110))
mtext(side=3,"Zipf",cex=1)
points(xs24otuRAD,col=2)
lines(xs24otuRAD,col=2)
points(xs25otuRAD,col=2)
lines(xs25otuRAD,col=2)
points(xs27otuRAD,col=2)
lines(xs27otuRAD,col=2)
points(xs29otuRAD,col=2)
lines(xs29otuRAD,col=2)
points(xs30otuRAD,col=2)
lines(xs30otuRAD,col=2)
points(xs31otuRAD,col=2)
lines(xs31otuRAD,col=2)
points(xs33otuRAD,col=2)
lines(xs33otuRAD,col=2)
points(xs34otuRAD,col=2)
lines(xs34otuRAD,col=2)
points(xs35otuRAD,col=2)
lines(xs35otuRAD,col=2)
points(xs36otuRAD,col=2)
lines(xs36otuRAD,col=2)
points(xs38otuRAD,col=2)
lines(xs38otuRAD,col=2)
points(xs40otuRAD,col=2)
lines(xs40otuRAD,col=2)
points(xs44otuRAD,col=2)
lines(xs44otuRAD,col=2)
plot(xs43otuRAD,col=11,ylim=c(1,6520),xlim=c(0,110))
mtext(side=3,"Lognormal",cex=1)
plot(xs37otuRAD,col=7,ylim=c(1,6520),xlim=c(0,110))
mtext(side=3,"Zipf-mandelbrot",cex=1)
points(xs42otuRAD,col=7)
lines(xs42otuRAD,col=7)
dev.off()
#5 11 and 22 didnt't converge so remove these
#head(cat)
xotuRAD<-radfit(t(cat[c(2,3,5,6:10,12:21,23:45)]))
#For specie T. auratis
xs1otuRAD<-rad.zipfbrot(t(cat[c(2)]))
xs2otuRAD<-rad.zipf(t(cat[c(3)]))
xs3otuRAD<-rad.zipf(t(cat[c(4)]))
# xs4otuRAD<-rad.zipfbrot(t(cat[c(5)])) didn't converge
xs5otuRAD<-rad.zipf(t(cat[c(6)]))
xs6otuRAD<-rad.zipf(t(cat[c(7)]))
xs7otuRAD<-rad.zipf(t(cat[c(8)]))
xs8otuRAD<-rad.zipf(t(cat[c(9)]))
xs9otuRAD<-rad.zipfbrot(t(cat[c(10)]))
#xs10otuRAD<-rad.zipfbrot(t(cat[c(11)]))#didn't converge
xs11otuRAD<-rad.lognormal(t(cat[c(12)]))
#For specie T.meloni
xs12otuRAD<-rad.zipf(t(cat[c(13)]))
xs13otuRAD<-rad.zipfbrot(t(cat[c(14)]))
xs14otuRAD<-rad.zipf(t(cat[c(15)]))
xs15otuRAD<-rad.zipf(t(cat[c(16)]))
xs16otuRAD<-rad.zipf(t(cat[c(17)]))
xs17otuRAD<-rad.zipf(t(cat[c(18)]))
xs18otuRAD<-rad.zipf(t(cat[c(19)]))
xs19otuRAD<-rad.zipfbrot(t(cat[c(20)]))
xs20otuRAD<-rad.zipfbrot(t(cat[c(21)]))
#xs21otuRAD<-rad.zipfbrot(t(cat[c(22)])) didn't converge
xs22otuRAD<-rad.zipf(t(cat[c(23)]))
#For species T.citroni
xs23otuRAD<-rad.zipf(t(cat[c(24)]))
xs24otuRAD<-rad.zipf(t(cat[c(25)]))
xs25otuRAD<-rad.zipf(t(cat[c(26)]))
xs26otuRAD<-rad.preempt(t(cat[c(27)]))
xs27otuRAD<-rad.zipf(t(cat[c(28)]))
xs28otuRAD<-rad.preempt(t(cat[c(29)]))
xs29otuRAD<-rad.zipf(t(cat[c(30)]))
xs30otuRAD<-rad.zipf(t(cat[c(31)]))
xs31otuRAD<-rad.zipf(t(cat[c(32)]))
xs32otuRAD<-rad.preempt(t(cat[c(33)]))
xs33otuRAD<-rad.zipf(t(cat[c(34)]))
xs34otuRAD<-rad.zipf(t(cat[c(35)]))
xs35otuRAD<-rad.zipf(t(cat[c(36)]))
xs36otuRAD<-rad.zipf(t(cat[c(37)]))
xs37otuRAD<-rad.zipfbrot(t(cat[c(38)]))
xs38otuRAD<-rad.zipf(t(cat[c(39)]))
xs39otuRAD<-rad.preempt(t(cat[c(40)]))
xs40otuRAD<-rad.zipf(t(cat[c(41)]))
xs41otuRAD<-rad.zipf(t(cat[c(42)]))
xs42otuRAD<-rad.zipfbrot(t(cat[c(43)]))
xs43otuRAD<-rad.lognormal(t(cat[c(44)]))
xs44otuRAD<-rad.zipf(t(cat[c(45)]))
#5 11 and 22 didnt't converge so remove these
#head(cat)
xotuRAD<-radfit(t(cat[c(2,3,4,6:10,12:21,23:45)]))
summary(xotuRAD)
xotuRAD_test<-rad_test(xotuRAD, conf.level = 0.95, log = T, )
xotuRAD_test<-rad_test(xotuRAD, conf.level = 0.95, log = T )
??rad.test
??rad_test
??rad_test
??rad_test()
xotuRAD_test<-rad.test(xotuRAD, conf.level = 0.95, log = T )
library(vegan)
library(matrixStats)
library(dplyr)
matrix_file<-"./Data/16and18s_otu.csv"
bact_matrix<-read.csv(matrix_file, head=T, sep="\t", row.names=1)
countSum<-apply(bact_matrix,1,sum)#sum the rows
pct<-countSum/sum(countSum)
all_matrix<-read.csv(matrix_file, head=T, sep="\t", row.names=1)
countSum<-apply(bact_matrix,1,sum)#sum the rows
pct<-countSum/sum(countSum)
bact_matrix<-cbind(bact_matrix, countSum, pct)
otus<-read.csv("./Data/16sans18s_taxa.csv", sep="\t")
otus<-read.csv("./Data/16ans18s_taxa.csv", sep="\t")
#BInd taxonomy to remove bacteria and
#two otus fromcoamplified sponges for 18s
taxa<-read.csv("./Data/18s/taxa_fixed18s.csv",sep=",")
otus<-arrange(otus, X.OTU.ID)
otus<-arrange(otus, sequence_identifier)
head(otus)
otus<-read.csv("./Data/16ans18s_taxa.csv", sep=";")
#BInd taxonomy to remove bacteria and
#two otus fromcoamplified sponges for 18s
taxa<-read.csv("./Data/18s/taxa_fixed18s.csv",sep=",")
otus<-arrange(otus, X.OTU.ID)
head(otus)
otus<-arrange(otus, sequence_identifier)
taxa<-arrange(taxa,sequence_identifier)
otu_and_taxa<-bind_cols(otus,taxa)
View(taxa)
matrix_file<-"./Data/16and18s_otu.csv"
otus<-read.csv("./Data/16and18s_otu.csv", sep=";")
#BInd taxonomy to remove bacteria and
#two otus fromcoamplified sponges for 18s
taxa<-read.csv("./Data/16ans18s_taxa.csv",sep=",")
otus<-arrange(otus, sequence_identifier)
taxa<-arrange(taxa,sequence_identifier)
#BInd taxonomy to remove bacteria and
#two otus fromcoamplified sponges for 18s
taxa<-read.csv("./Data/16ans18s_taxa.csv",sep=";")
otus<-arrange(otus, sequence_identifier)
head(otus)
otus<-arrange(otus, X.OTU.ID)
taxa<-arrange(taxa,sequence_identifier)
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria"&&data=="18s")
View(otu_and_taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria"&&dataset=="18s")
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria"&&dataset=="18s"))
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
View(otu_and_taxa)
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU 1 for sponge amplification
head(otus_and_taxa)
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU 1 for sponge amplification
head(otu_and_taxa)
otu_and_taxa[otu_and_taxa$ï..dataset]
otu_and_taxa[otu_and_taxa$ï..dataset,]
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU 1 for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa[otu_and_taxa$ï..dataset,]
#and remove two otus fromcoamplified sponges for 18s
#Take out OTU 1 for sponge amplification
head(otu_and_taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
otu_and_taxa<-bind_cols(otus,taxa)
otu_and_taxa<-otu_and_taxa%>%filter(!(Domain=="Bacteria" & dataset=="18s"))
otu_and_taxa<-otu_and_taxa[!otu_and_taxa$ï..dataset,]
otu_and_taxa<-otu_and_taxa![otu_and_taxa$ï..dataset,]
otu_and_taxa<-otu_and_taxa[-c(otu_and_taxa$ï..dataset),]
otu_and_taxa<-otu_and_taxa[-otu_and_taxa$ï..dataset]
otu_and_taxa<-otu_and_taxa[-c(otu_and_taxa$ï..dataset)]
otu_and_taxa<-otu_and_taxa[-c("ï..dataset")]
otu_and_taxa<-otu_and_taxa[-c("ï..dataset"),]
otu_and_taxa<-otu_and_taxa!["ï..dataset"]
otu_and_taxa<-otu_and_taxa![ï..dataset]
otu_and_taxa<-otu_and_taxa[-c(47)]
countSum<-apply(otu_and_taxa,1,sum)
countSum<-apply(otu_and_taxa[3:46],1,sum)
otus_and_taxa<-cbind(otus_and_taxa,countSum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
arrange(otus_and_taxa[dataset=="18s"],countSum)
arrange(otus_and_taxa[otus_and_taxa$dataset=="18s"],countSum)
arrange(otus_and_taxa[otus_and_taxa$dataset=="18s",],countSum)
coamplif_sponge<-arrange(otus_and_taxa[otus_and_taxa$dataset=="18s",],countSum)
View(coamplif_sponge)
coamplif_sponge<-order(otus_and_taxa[otus_and_taxa$dataset=="18s",],countSum)
coamplif_sponge<-desc(otus_and_taxa[otus_and_taxa$dataset=="18s",],countSum)
coamplif_sponge<-arrange(desc(otus_and_taxa[otus_and_taxa$dataset=="18s",],countSum))
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
View(coamplif_sponge)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))%>%
remove(c(1,2),)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))%>%
remove(slice_head(n=5))
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))%>%
remove(slice_head(n=2))
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))%>%
slice(-c(1:2)))
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))%>%
slice(-c(1,2)))
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))%>%
slice(-c(1,2))
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
coamplif_sponge$sequence_identifier[1,2]
coamplif_sponge$sequence_identifier[1]
coamplif_sponge$sequence_identifier[2]#OTU_4076
otus_and_taxa<-otu_and_taxa[!(otu_and_taxa$X.OTU.ID=="OTU_4076"),]
otus_and_taxa<-otu_and_taxa[!(otu_and_taxa$X.OTU.ID=="OTU_4206"|otu_and_taxa$X.OTU.ID=="OTU_2"),]
#fILTER TO KEEP TOP 95%
pct<-countSum/sum(countSum)
#fILTER TO KEEP TOP 95%
pct<-otus_and_taxa$countSum/sum(otus_and_taxa$countSum)
otus_and_taxab<-cbind(otus_and_taxa, pct)
#fILTER TO KEEP TOP 95%
pct<-otus_and_taxa$countSum/sum(otus_and_taxa$countSum)
View(otus_and_taxa)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otu_and_taxa[!(otu_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4206
otus_and_taxa<-otu_and_taxa[!(otu_and_taxa$X.OTU.ID=="OTU_4206"|otu_and_taxa$X.OTU.ID=="OTU_2"),]
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4206
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4206"),]
#fILTER TO KEEP TOP 95%
pct<-otus_and_taxa$countSum/sum(otus_and_taxa$countSum)
otus_and_taxa<-cbind(otu_and_taxa,countSum)
coamplif_sponge<-otus_and_taxa[otus_and_taxa$dataset=="18s",]%>%
arrange(desc(countSum))
#
coamplif_sponge$sequence_identifier[1]#OTU_4076
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4076"),]
coamplif_sponge$sequence_identifier[2]#OTU_4206
otus_and_taxa<-otus_and_taxa[!(otus_and_taxa$X.OTU.ID=="OTU_4206"),]
#fILTER TO KEEP TOP 95%
pct<-otus_and_taxa$countSum/sum(otus_and_taxa$countSum)
otus_and_taxab<-cbind(otus_and_taxa, pct)
bact_matrix<-bact_matrix%>%
arrange(desc(pct))
otus_and_taxac%>%otuandtaxab
otus_and_taxac%>%otus_and_taxab
otus_and_taxa<-cotus_and_taxab%>%
arrange(desc(pct))
otus_and_taxac<-otus_and_taxab%>%
arrange(desc(pct))
otus_and_taxac<-otus_and_taxab%>%
mutate(cumpct=cumsum(pct))
View(otus_and_taxac)
otus_and_taxab<-cbind(otus_and_taxa, pct)
otus_and_taxac<-otus_and_taxab%>%
arrange(desc(pct))
otus_and_taxac<-otus_and_taxac%>%
mutate(cumpct=cumsum(pct))
View(otus_and_taxac)
otus_and_taxac<-otus_and_taxac[otus_and_taxac$cumpct < 0.97,]
oat<-otus_and_taxac[,-c(1,47:57)]
#rEMOVE SEQUENCE id AS A COLUMN AND MAKE THEM THE ROW NAMES
row.names(oat)<-oat$X.OTU.ID
View(oat)
#remove column with id names and taxa columns again
oat<-oat[,-1]
#group vectors for non bactloadCorrected datasets
num_groups<-c(1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3)
label_groups<-c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci")
head(d18s_matrix)
head(oat)
dim(oat)
nmds<-metaMDS(t(oat), try=50)
plot(nmds, type = "t", display="sites")
points(nmds, col=num_groups, cex=1.5, pch=16)
ordispider(nmds, label_groups, label=T)
x<-anosim(t(d18s_matrix[,-c(45,46,47)]), num_groups)
x<-anosim(t(oat), num_groups)
hist(x)
x<-anosim(t(oat), num_groups)
hist(x)
x$statistic
hist(x$perm)
#vector
species_vector<-data.frame(Species=c("Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tau","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tme","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci","Tci"))
#adonis(t(bact_matrix)~Condition, data=temp_treatments, strata=temp_treatments$Sponge_type)
bact_cca<-cca(t(d18s_matrix[,-c(45,46,47)])~Species, data=species_vector)
#adonis(t(bact_matrix)~Condition, data=temp_treatments, strata=temp_treatments$Sponge_type)
meta_cca<-cca(t(oat~Species, data=species_vector)
plot(meta_cca, type="t", display="sites")
#adonis(t(bact_matrix)~Condition, data=temp_treatments, strata=temp_treatments$Sponge_type)
meta_cca<-cca(t(oat~Species, data=species_vector))
plot(meta_cca, type="t", display="sites")
#adonis(t(bact_matrix)~Condition, data=temp_treatments, strata=temp_treatments$Sponge_type)
meta_cca<-cca(t(oat)~Species, data=species_vector)
plot(meta_cca, type="t", display="sites")
points(meta_cca, col=num_groups, cex=1.5, pch=16)
ordispider(bact_cca, label_groups, label=T)
summary(bact_cca)
ordispider(meta_cca, label_groups, label=T)
summary(meta_cca)
anova(meta_cca)
anova(meta_cca, by="term")
anova(meta_cca, by="margin")
is.matrix(oat)
matrixoat<-as.matrix(oat)
matrix_zscores<-((matrixoat-matrix_rMeans)/matrix_rSds)
matrix_rMeans<-rowMeans(matrixoat)
matrix_rSds<-rowSds(matrixoat)
matrix_zscores<-((matrixoat-matrix_rMeans)/matrix_rSds)
OTUVars<-sort(rowVars(matrixoat,useNames = T),decreasing = T)
variableOTUs<-names(head(OTUVars, n=25L))
heatmap(as.matrix(matrix_zscores)) #ColSideColors = c("blue","red","red","blue","blue","blue","blue","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","red","blue","red","red","blue","blue","blue","blue","blue","blue","green","green","red","green","green","red","red","red","blue","blue","green","green","green","green","green","green","green"))
heatmap(as.matrix(matrix_zscores[rownames(matrix_zscores) %in% variableOTUs,]))
